---
title: "Journal--Chase Africa "
output:
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
---
# Makefile

This is what my makefile looks like graphically at the minute:

```{r, echo = FALSE, out.width='100%'}
knitr::include_graphics(paste0(rprojroot::find_root("Makefile"),"/figures/make.png"))
```

# Monday 29.10.2018

1. Initialise repository

2. Move data into `raw` data folder, make sure not in repository. 

3. What are the data files? Outline sheets

# Tuesday 30.10.2018

1. Finish the CHAT file outline

2. Go through all files and complete outline of data. write up in `01-data_outline.Rmd`

3. Update makefile

# Thursday 22.11.2018

1. OK, now I'm meant to do some 'analysis'. 

2. OK, so first thing is consolidating all the data into one file. Doing this manually will be a pain, but also really bad practice. Let's see if `readxl` might not be an option.

3. OK, Dandelion 2014 done. 

4. Dandelion 2015 - mixed data in one of the date cells... A bitch to disentangle programmatically, ha. 

5. OK, dandelion 2016. Had to remove a whole "funding period", not sure how this works!

6. Tried to dabble with moving averages, but got a bit too intense..

7. OK, Dandelion 2017

# Friday 23.11.2018

1. Hmm, should I actually keep the odd ones, the weird funders? I mean in the end they will presumably be still in the analysis, so I might as well sort this out now...

2. OK, back to 2016 and add "amplify change" back in. 

3. And back to 2017 with Amboseli added in. 

4. 2018 now. Found error in pills CYP in the final sheet. 

5. OK, all data together now. Start row bind with 2018 dataframe, just to keep the columns in that order, since there are most in that table. 

6. Now sort by date. 

7. Now update makefile. I really need to start doing this earlier, not later!

8. Update readme

9. TODO:

* prepare presentation folder/gh_pages
* group data monthly?

# Monday 26.11.2018

1. Preapre presentation folder/gh_pages.. xaringan, right?

2. ALso update readme and add to makefile.

3. OK, now what to do with the data. Should I have a look at another dataset? No, keep it simple and do dandelion only.

4. Start preliminary analysis report. 

5. Rename variables so they are fp_ family planning, ihs for integrated health services and fund for funding related stuff. 

6. Derive totals for family planning and check with the ones in the excel spreadsheet - correct. 

7. Derive CYP totals 

# Tuesday 27.11.2018

1. Fix NAs e.g. in 2015 pills. 

2. Makefile: interim data and transform data script. 

3. OK, derive CYP total, as well as sub totals. Compare with original version. 71 are the same and the other 81 are not.. But that's not my error, it's theirs since they had teh CYP conversion factors entered in wrong. 

4. There are two more totals, IHS and IHS+FP together, do those and double check. In order to do those need to rename the `ihs_`variables. And careful to not count positive tests as people.. One check revealed swapped columns in 2018. other check revealed: in 2017 the total IHC formula included the hiv pozitives. 

5. Now figure out smoothing lines - I guess in ggplot if I want to use gganimate..

6. But maybe first add summaries per funding round. OK

7. No, even before, add the list of variables to the appendix. OK

8. Now update makefile. OK

9. Now back to summaries per year and per round. How do you do this: different groups of variables need different funcitons: some sum, some mean, some max, some first(). OK, what di I realy want to do:

First by funding round:

* drop date and venue
* sum the next 28 variables. 
* first the five funding variables - although one is the grouping one. 
* sum all the remaining variables. 

OK, so sum all non-funding variables. Do that using mutate, then summarise. 

10. Now need cost per person and cost per Couple Year protection. OK, GBP per FP person checks out with the Excel data. And CYP as well - well, except for the CYPs that were wrong in the Excel files. And I assume the Ksh are correct as well, although only checked a few. 

11. Now summarise by year and by funding round. Careful that the cost per person or per CYP is calculated correctly as well. 

12. Only issue with summaries is that they include the non-standard funding rounds. Maybe I can have a look at what happens without them? Meh, actually, let's not complicate things. But I left the code in. 

13. Now smoothing lines in ggplot2

14. check if kable can't have a bit more pzzaz? Done

15. OK< plots, set up makefile. 